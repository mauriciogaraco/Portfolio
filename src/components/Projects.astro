---
import { projects } from "../data/projects";
import SocialPill from "./SocialPill.astro";
import ArrowLeftIcon from "./icons/ArrowLeftIcon.astro";
---

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  {projects.map((project) => (
    <article class="mb-6 group">
      <div class="relative rounded-2xl bg-gradient-to-tr from-yellow-200/40 via-yellow-500/20 to-transparent p-[1px]">
        <div
          class="rounded-2xl bg-gray-900/90 light:bg-white light:shadow-sm border border-white/5 light:border-gray-200
                 transition-all duration-300 ease-out hover:shadow-2xl hover:shadow-yellow-500/10 hover:scale-[1.01] motion-safe:transform"
        >
          <!-- Link de portada -->
          <a
            href={`/projects/${project.key}`}
            class="block relative rounded-t-2xl focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-400"
            rel="prefetch-intent"
            aria-label={`Ver detalles de ${project.title}`}
          >
            <div class="relative overflow-hidden rounded-t-2xl">
              <img
                src={project.image}
                alt={project.title}
                class="h-48 w-full object-cover"
                loading="lazy"
                decoding="async"
                fetchpriority="low"
              />
              <!-- overlay para contraste del título si lo colocas encima -->
              <div class="pointer-events-none absolute inset-0 bg-gradient-to-t from-black/60 via-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
            </div>
          </a>

          <div class="p-5">
            <h5 class="mb-2 text-xl font-semibold tracking-tight text-yellow-200 light:text-yellow-700">
              <a
                href={`/projects/${project.key}`}
                class="hover:underline focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-400 rounded"
              >
                {project.title}
              </a>
            </h5>

            <p class="mb-4 text-sm text-gray-300 light:text-gray-700 line-clamp-3">
              {project.description}
            </p>

            <!-- TAGS: marquee infinito derecha→izquierda -->
            <div class="relative overflow-hidden">
              <div class="flex gap-2 whitespace-nowrap animate-marquee will-change-transform">
                {project.tags.map((tags: any) => (
                  <span class="inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs 
                               ring-1 ring-white/10 light:ring-gray-300 bg-white/5 light:bg-gray-100 
                               hover:bg-white/10 light:hover:bg-gray-200 transition">
                    <tags.icon class="size-4 opacity-80" />
                    <span>{tags.name}</span>
                  </span>
                ))}
                {project.tags.map((tags: any) => (
                  <span class="inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs 
                               ring-1 ring-white/10 light:ring-gray-300 bg-white/5 light:bg-gray-100 
                               hover:bg-white/10 light:hover:bg-gray-200 transition">
                    <tags.icon class="size-4 opacity-80" />
                    <span>{tags.name}</span>
                  </span>
                ))}
              </div>
            </div>

            <div class="flex mt-2">
              <SocialPill
                href={`/projects/${project.key}`}
                aria-label={`Ir a ${project.title}`}
              >
                Go
                <ArrowLeftIcon />
              </SocialPill>
            </div>
          </div>
        </div>
      </div>
    </article>
  ))}
</div>

<style>
  @keyframes marquee {
    0%   { transform: translateX(0); }
    100% { transform: translateX(-50%); } /* se mueve la mitad porque duplicamos el contenido */
  }
  .animate-marquee { animation: marquee 10s linear infinite; }
  .animate-marquee:hover { animation-play-state: paused; }
</style>
